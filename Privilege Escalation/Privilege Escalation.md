# [Windows Privilege Escalation Cheet Sheet]()

# [Linux Privilege Escalation Cheet Sheet]()

# Gneric Manual Enumeration

## Enumerating Users

> Windows
```
C:\Users\student> whoami
C:\Users\student> net user
```
> Linux
```
student@debian:~$ id
```

## Enumerating the Hostname

> Windows & Linux
```
C:\Users\student> hostname
client251

student@debian:~$ hostname
debian
```

## Enumerating the Operating System Version and Architecture

> Windows
```
C:\Users\student> systeminfo
```
> Linux
```
student@debian:~$ cat /etc/issue
student@debian:~$ cat /etc/*-release
student@debian:~$ uname -a
```

## Enumerating Running Processes and Services

> Windows | /SVC flag will return processes that are mapped to a specific Windows service.
```
C:\Users\student> tasklist /SVC
```
>Linux | a and x flags to list all processes with or without a tty, u flag to list the processes in a user-readable format.
```
student@debian:~$ ps axu
```

## Enumerating Networking Information

>Windows
```
C:\Users\student> ipconfig /all
C:\Users\student> route print
C:\Users\student> netstat -ano
```
>Linux | ss & netstat, both of which accept the same arguments.
```
student@debian:~$ ip a
student@debian:~$ /sbin/route
student@debian:~$ ss -anput
```

## Enumerating Firewall Status and Rules

>Windows
```
C:\Users\student> netsh advfirewall show currentprofile
C:\Users\student> netsh advfirewall firewall show rule name=all
```
>Linux

> **iptables** need **root privileges**, depending on how the firewall is configured

> **/etc/iptables** directory by default | These files are often left with weak permissions, allowing them to be read by any local user on the target system.

> **iptables-save** used to dump the firewall configuration to a file specified by the user | This file is then usually used as input for the iptables-restore command and used to restore the firewall rules at boot time.

## Enumerating Scheduled Tasks

>Windows

> Or find the schtasks folder under **C:\Program Files (x86)**
```
c:\Users\student> schtasks /query /fo LIST /v
```
>Linux

>Scheduled tasks are listed under the **/etc/cron.***

>**/etc/crontab** file for custon Scheduled tasks | most jobs in this particular file will run as root.
```
student@debian:~$ ls -lah /etc/cron*
student@debian:~$ cat /etc/crontab
```

## Enumerating Installed Applications and Patch Levels

> Windows

> enumeration of all installed applications | use this information to search for a matching exploit.

> **wmic** to automate this process on Windows systems.
```
c:\Users\student> wmic product get name, version, vendor
c:\Users\student> wmic qfe get Caption, Description, HotFixID, InstalledOn
```
>Linux
```
student@debian:~$ dpkg -l
```

## Enumerating Readable/Writable Files and Directories

>Windows
```
c:\Tools\privilege_escalation\SysinternalsSuite> accesschk.exe -uws "Everyone" "C:\Program Files"

Get-ChildItem "C:\Program Files" -R ecurse | Get-ACL | ?{$_.AccessToString -match "Everyone\sAllow\s\sModify"}
```
>Linux
```
student@debian:~$ find / -writable -type d 2>/dev/null
```

## Enumerating Unmounted Disks

>Windows
```
c:\Users\student> mountvol
```
>Linux
```
student@debian:~$ cat /etc/fstab
student@debian:~$ mount
student@debian:~$ /bin/lsblk
```

## Enumerating Device Drivers and Kernel Modules

>Windows
```
driverquery.exe /v /fo csv | ConvertFrom-CSV | Select-Object "Display Name", "Start Mode", Path

Get-WmiObject Win32_PnPSignedDriver | Select-Object DeviceName, DriverVersion, Manufacturer | Where-Object {$_.DeviceName -like "*VMware*"}
```
>Linux
```
student@debian:~$ lsmod
student@debian:~$ /sbin/modinfo libata
```

## Enumerating Binaries That AutoElevate

>Windows | Powershell
```
reg query HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer

reg query HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Installer
```
>Linux
```
student@debian:~$ find / -perm -u=s -type f 2>/dev/null
```